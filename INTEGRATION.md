# Интеграция Frontend + Backend

## Быстрый старт

### 1. Запуск бэкенда

```powershell
# В папке backend
.venv\Scripts\Activate.ps1
python -m uvicorn main:app --reload
```

Бэкенд будет доступен на: http://localhost:8000

### 2. Запуск фронтенда

```powershell
# В папке frontend
npm install  # если еще не установлены зависимости
npm run dev
```

Фронтенд будет доступен на: http://localhost:8080

## Что было сделано

### Backend (FastAPI)
- ✅ Добавлен CORS middleware для работы с фронтендом
- ✅ Расширена модель Course: добавлены поля `image`, `rating`, `review_count`, `price`, `level`
- ✅ Обновлены seed данные с реальными курсами на русском языке
- ✅ Все эндпоинты возвращают полные данные курсов

### Frontend (React + TypeScript)
- ✅ Создан API клиент (`src/lib/api.ts`) для работы с бэкендом
- ✅ Компонент `Courses.tsx` подключен к реальному API
- ✅ Компонент `CoursePage.tsx` подключен к реальному API
- ✅ Используется React Query для кеширования и управления состоянием

## API Endpoints

- `GET /courses` - список всех курсов (опционально `?published_only=true`)
- `GET /courses/{id}` - детали курса
- `POST /enroll` - записаться на курс
- `GET /users/{id}/courses` - курсы пользователя
- `PATCH /enrollments/{id}/progress` - обновить прогресс

## Настройка переменных окружения

Во фронтенде можно настроить URL бэкенда через переменную окружения:

Создайте файл `.env` в папке `frontend`:
```
VITE_API_URL=http://localhost:8000
```

## Проверка работы

1. Запустите бэкенд
2. Запустите фронтенд
3. Откройте http://localhost:8080/courses
4. Должны отобразиться курсы из базы данных

## Деплой на реальный сервер

### Для учебного проекта (демонстрация)

**Вариант 1: Локальная демонстрация**
- Запустите оба сервера локально
- Используйте для показа на паре
- Не требует деплоя

**Вариант 2: Бесплатный хостинг (для демо)**

#### Backend (FastAPI):
- **Render.com** (бесплатно): https://render.com
  - Подключите GitHub репозиторий
  - Выберите "Web Service"
  - Build Command: `pip install -r requirements.txt`
  - Start Command: `uvicorn main:app --host 0.0.0.0 --port $PORT`
  
- **Railway.app** (бесплатно): https://railway.app
  - Автоматически определит FastAPI
  - Просто подключите репозиторий

#### Frontend (Vite + React):
- **Vercel** (бесплатно): https://vercel.com
  - Подключите GitHub репозиторий
  - Автоматически определит Vite
  - Добавьте переменную окружения: `VITE_API_URL=https://your-backend-url.onrender.com`

- **Netlify** (бесплатно): https://netlify.com
  - Build command: `npm run build`
  - Publish directory: `dist`
  - Добавьте переменную окружения для API URL

### Важно для деплоя:

1. **База данных**: SQLite не подходит для продакшена
   - Используйте PostgreSQL (Render, Railway предоставляют бесплатно)
   - Или используйте SQLite для демо (данные могут теряться)

2. **CORS**: Обновите `allow_origins` в `main.py`:
   ```python
   allow_origins=["https://your-frontend-domain.vercel.app"]
   ```

3. **Переменные окружения**: Используйте `.env` файлы или настройки хостинга

## Для показа преподу

### Локальная демонстрация (рекомендуется):
1. Запустите бэкенд в одном терминале
2. Запустите фронтенд в другом терминале
3. Покажите работу в браузере
4. Покажите Swagger UI: http://localhost:8000/docs

### Онлайн демонстрация:
1. Задеплойте на бесплатные хостинги (см. выше)
2. Покажите работающее приложение онлайн

## Структура проекта

```
PCHMI/
├── backend/
│   ├── main.py          # FastAPI приложение
│   ├── requirements.txt  # Зависимости Python
│   ├── app.db           # SQLite база данных (создается автоматически)
│   └── .venv/           # Виртуальное окружение
│
└── frontend/
    ├── src/
    │   ├── lib/
    │   │   └── api.ts   # API клиент
    │   └── pages/
    │       ├── Courses.tsx      # Страница курсов (подключена к API)
    │       └── CoursePage.tsx   # Страница курса (подключена к API)
    └── package.json
```

## Troubleshooting

### Ошибка CORS
- Убедитесь, что бэкенд запущен
- Проверьте, что в `main.py` указан правильный порт фронтенда (8080)

### Курсы не загружаются
- Проверьте, что бэкенд запущен на http://localhost:8000
- Откройте консоль браузера (F12) для просмотра ошибок
- Проверьте, что база данных создана (файл `app.db` должен существовать)

### База данных пустая
- Удалите `app.db` и перезапустите бэкенд
- Данные автоматически загрузятся при первом запуске


